rules:
  # High-risk patterns that should trigger blocking
  block:
    - name: "SQL Injection Pattern"
      pattern: "(?i)(union|select|insert|delete|update|drop|alter|exec|execute|script)"
      severity: 0.9
      description: "Detects SQL injection attempts"
    
    - name: "Command Injection"
      pattern: "(?i)(\\||;|&&|`|\\$\\{|eval|exec|system)"
      severity: 0.85
      description: "Detects command injection patterns"
    
    - name: "XSS Pattern"
      pattern: "(?i)(<script|javascript:|onerror=|onload=|onclick=)"
      severity: 0.8
      description: "Detects cross-site scripting attempts"
    
    - name: "Path Traversal"
      pattern: "(?i)(\\.\\./|\\.\\.\\\\|/etc/passwd|/etc/shadow)"
      severity: 0.75
      description: "Detects path traversal attempts"
    
    - name: "Sensitive Data Request"
      pattern: "(?i)(password|secret|api[_-]?key|token|credential|ssn|social[_-]?security)"
      severity: 0.7
      description: "Detects requests for sensitive information"
  
  # Medium-risk patterns that may trigger redaction
  redact:
    - name: "Email Pattern"
      pattern: "\\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Z|a-z]{2,}\\b"
      severity: 0.5
      description: "Detects email addresses"
    
    - name: "Phone Number"
      pattern: "\\b(\\+?1[-.]?)?\\(?[0-9]{3}\\)?[-.]?[0-9]{3}[-.]?[0-9]{4}\\b"
      severity: 0.4
      description: "Detects phone numbers"
    
    - name: "Credit Card Pattern"
      pattern: "\\b(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|3[47][0-9]{13})\\b"
      severity: 0.6
      description: "Detects credit card numbers"
    
    - name: "IP Address"
      pattern: "\\b(?:[0-9]{1,3}\\.){3}[0-9]{1,3}\\b"
      severity: 0.3
      description: "Detects IP addresses"

